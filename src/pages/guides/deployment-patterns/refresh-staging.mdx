import { Callout } from "nextra/components";

# Refresh Staging

If you are using `DEV`, `STAGE`, and `PROD` servers, this pattern will be interesting to you.

## Problem

How do we keep the staging server up to date with the latest code from the `DEV` server and the latest production data from the `PROD` server?

<Callout>
  This pattern will move **all the data** from the `PROD` server to the `STAGE`
  server. This may not be what you want. If you want to move only some of the
  data, that is more complicated.
</Callout>

## Solution

Use two sub-deployments, one to pull the production data from the `PROD` server to `STAGE` and one to pull the latest code from the `DEV` server. Switch on the `Abort remaining sub-deployments` option. That way, if the first deployment fails, the second one will not run.

### Advanced options

You will need to turn on the "Advanced options" in the deployment settings to use the Sub-deployments and Abort Remaining sub-deployments features.

import { Steps, Callout } from "nextra/components";
import { Bleed } from "nextra-theme-docs";

# How to use API Keys

## Introduction

OttoFms provides an Api Key service to make it easier to use the FileMaker Data API by handling the token exchange and refreshing you need to do to use the Data API. Without Otto you need to login with a user name and password first to get an access token then you can use that token to make calls to the Data API. With OttoFms you can setup an API Key to access a given file with a user name and password and then use that API Key to make calls to the Data API. Otto will handle the token exchange and updating for you.

The API Key can be safely given to 3rd party integrations and services to access your FileMaker data without giving them access to your FileMaker user name and password.

## Before you begin

**Before you begin you should check off everything in this list:**

- [ ] OttoFms is running on a FileMaker server version 19.6 or later
- [ ] FileMaker Data API is enabled on the server
- [ ] The FileMaker file you want to access is hosted on the server
- [ ] You have a user name and password for the file that has the correct privilege set to access the Data API
- [ ] You are be able to make Data APIrRequest the native way without using an API Key.

If you don't have this checklist completed, you may struggle with the steps below

## Create an API Key

Once you sure your server is ready, create an API Key, by following these steps.

<Steps>
### Login to OttoFms
Login to the [OttoFms web console](/otto-console).

### Navigate to Api Keys

Navigate to the [Api Keys page](/otto-console/api-keys) in the web console.

### Create a new API Key

Click the "Create API Key" button in the upper left to create a new API Key.
![New Api Key Button](/img/ottofms/guides/new-api-key-button.png)

### Fill out the form

Fill out the form in the modal dialog that pops ups. When you have entered everything correctly click the Create Button. If you have everything configured correctly and you have the right user name and password, you won't get an error.
![New Api Key Form](/img/ottofms/guides/new-api-key-form.png)

### Copy the API Key

If you have everything correct you will be able to copy the newly created API Key.
![New Api Key Form](/img/ottofms/guides/copy-api-key.png)

### Success

You have successfully created an API Key. You can now use this API Key to access the FileMaker Data API.

</Steps>

## Using an API Key to make a Request

### Use a different url

<Callout type="info">
	**Important** You will need to use a slightly different url when access the
	data api with a an API Key.
</Callout>

Add `/otto` just before the `/fmi/` segment in any Data API request. This will send the request through OttoFms and it will be able to use the Api Key

For example, change this url path:

```
/fmi/data/vLatest/databases/{database.fmp12}/layouts/{layout}/records
```

to this path

```
/otto/fmi/data/vLatest/databases/{database.fmp12}/layouts/{layout}/records
```

<Callout type="warning">
	**File extension matters** Always add `.fmp12` to the end of the database name
	in the url.
</Callout>

### Authentication

Pass the API Key to the request in one of 2 ways.

- As Bearer Token in an Authorization header, just like you would do with the access token.
- As query parameter `?apiKey={API_KEY}`
- as basic auth in the url

```
https://apiKey:{API_KEY}@your.server.com/otto/fmi/data/vLatest/databases/{database.fmp12}/layouts/{layout}/records
```

## Video

Here is a video that shows how to create an API Key and use it to make a request to the Data API.

---

<div style={{ padding: "56.25% 0 0 0", position: "relative" }}>
	<iframe
		src="https://player.vimeo.com/video/890122764?h=b8586bf005&amp;badge=0&amp;autopause=0&amp;quality_selector=1&amp;player_id=0&amp;app_id=58479"
		frameborder="0"
		allow="autoplay; fullscreen; picture-in-picture"
		title="OttoFms"
		style={{
			position: "absolute",
			top: 0,
			left: 0,
			width: "100%",
			height: "100%",
		}}
	></iframe>
</div>
<script src="https://player.vimeo.com/api/player.js"></script>
